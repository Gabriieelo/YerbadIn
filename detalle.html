<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Detalle del Producto</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="estilos.css">
</head>
<body>
  <h1 class="titulo text-center mt-4">Bienvenido a Yerbadin</h1>
  <h3 class="subtitulo text-center">
    Nuestro objetivo es dar nuestro punto de vista y comentar sobre las yerbas que se comercializan en Argentina
    para informar y que puedas saber qué yerba te podría llegar a gustar más
  </h3>

  <div class="container mt-5" id="detalle-producto"></div>

  <div class="text-center mt-4">
    <a href="inicio.html" class="btn btn-secondary">Volver al inicio</a>
  </div>

  <script>
    const airtableToken = "patVhTGXMmBRjvBCK.f28a2d4af45d46b8a777e24ee48ddde443475a91d946a96f307661175073f672";
    const baseId = "app4MOjY3G8sHauiV";
    const tableName = "Productos";
    const airtableUrl = `https://api.airtable.com/v0/${baseId}/${tableName}`;

    async function cargarDetalle() {
      const id = localStorage.getItem("productoSeleccionado");
      if (!id) {
        document.getElementById("detalle-producto").innerHTML = "<p>No se encontró el producto.</p>";
        return;
      }

      try {
        const response = await fetch(`${airtableUrl}/${id}`, {
          headers: { Authorization: `Bearer ${airtableToken}` },
        });

        if (!response.ok) throw new Error("Error al obtener el producto");
        const record = await response.json();
        const { Nombre, Detalle, Imagen } = record.fields;
        const imagenUrl = Imagen && Imagen[0] ? Imagen[0].url : "placeholder.jpg";

        document.getElementById("detalle-producto").innerHTML = `
          <div class="card mx-auto shadow-lg" style="max-width: 600px;">
            <img src="${imagenUrl}" class="card-img-top" alt="${Nombre}">
            <div class="card-body text-center">
              <h2 class="card-title">${Nombre}</h2>
              <p class="card-text">${Detalle || "Sin descripción disponible."}</p>
              <button class="btn btn-success mt-2">Agregar al carrito</button>
            </div>
          </div>
        `;
      } catch (error) {
        console.error(error);
        document.getElementById("detalle-producto").innerHTML = "<p class='text-danger'>Error al cargar el detalle.</p>";
      }
    }

    cargarDetalle();
  </script>
</body>
</html>
